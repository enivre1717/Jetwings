"use strict";own_expenses.controller("OwnExpensesController",["$scope","$rootScope","$route","$location","$http","$uibModal","$window","ownExpensesModel",function($scope,$rootScope,$route,$location,$http,$uibModal,$window,ownExpensesModel){var fitBookingId=$route.current.params.fitBookingId;$scope.ownExpenses={},$scope.ownExpenses.fitBookingId=fitBookingId,$scope.ownExpenses.attractions=[],$scope.ownExpenses.attractions.push({attraction:""}),$scope.ownExpenses.names=[],$scope.ownExpenses.names.push({name:""}),$scope.addAttraction=function(){$scope.ownExpenses.attractions.push({attraction:""})},$scope.addName=function(){$scope.ownExpenses.names.push({name:""})},$scope.submitForm=function(ownExpenses){ownExpenses.signature='{"lines":[]}'!=$("#signature").val()?$("#signature").val():"",ownExpenses.tourLeaderSignature='{"lines":[]}'!=$("#tour_leader_signature").val()?$("#tour_leader_signature").val():"",ownExpensesModel.submitForm(ownExpenses).then(function(results){void 0!==results.data.errors&&Object.keys(results.data.errors).length>0?$scope.errors=results.data.errors:("true"==results.data?$rootScope.showNotification("自费旅游项目协议书已成功提交。","success"):$rootScope.showNotification("自费旅游项目协议书未提交。","error"),$location.path("/fitbookings/forms/"+ownExpenses.fitBookingId))}).catch(function(error){401==error.status?$location.path("/"):console.log("Error occurred in saving own expenses form.")})},$("#Signature").signature({syncField:$("#Signature").next("input")}),$("#TourLeaderSignature").signature({syncField:$("#TourLeaderSignature").next("input")}),$(".clearButton a").click(function(e){e.preventDefault(),$(this).parents(".sigWrapper").find(".sigPad").signature("clear"),$(this).parents(".sigWrapper").find(".sigPad").next("input").val("")})}]);